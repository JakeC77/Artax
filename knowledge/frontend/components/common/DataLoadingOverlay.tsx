import { Box, Typography, keyframes, useTheme } from '@mui/material'
import { alpha } from '@mui/material/styles'

const pulse = keyframes`
  0% {
    transform: scale(0.95);
    opacity: 0.8;
  }
  50% {
    transform: scale(1);
    opacity: 1;
  }
  100% {
    transform: scale(0.95);
    opacity: 0.8;
  }
`

const rotate = keyframes`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`

export function DataLoadingOverlay({
  message = 'Saving into workspace',
  variant = 'page',
}: {
  message?: string
  variant?: 'page' | 'container'
}) {
  const theme = useTheme()
  const isContainer = variant === 'container'

  return (
    <Box
      sx={{
        position: isContainer ? 'absolute' : 'fixed',
        top: 0,
        left: 0,
        right: 0,
        bottom: 0,
        bgcolor: alpha(theme.palette.background.default, 0.9),
        zIndex: 9999,
        display: 'flex',
        flexDirection: 'column',
        alignItems: 'center',
        justifyContent: 'center',
        gap: 3,
      }}
    >
      <Box sx={{ position: 'relative', width: 264, height: 281 }}>
        {/* Animated rings background */}
        <Box
          sx={{
            position: 'absolute',
            top: 0,
            left: 0,
            width: '100%',
            height: '100%',
            animation: `${rotate} 10s linear infinite`,
            transformOrigin: '129.557px 142.009px',
          }}
        >
           <svg width="264" height="281" viewBox="0 0 264 281" fill="none" xmlns="http://www.w3.org/2000/svg" style={{ position: 'absolute', top: 0, left: 0 }}>
             <circle cx="129.557" cy="142.009" r="68.7559" fill="#C6A664" fillOpacity="0.2" stroke="#F4F0E6"/>
             <circle cx="129.557" cy="142.009" r="95.229" stroke="#F4F0E6" strokeOpacity="0.2" strokeWidth="0.5"/>
             <circle cx="129.557" cy="142.009" r="112.711" stroke="#F4F0E6" strokeOpacity="0.1" strokeWidth="0.5"/>
           </svg>
        </Box>

        {/* Main static content with pulse */}
        <Box sx={{ animation: `${pulse} 2s ease-in-out infinite` }}>
          <svg width="264" height="281" viewBox="0 0 264 281" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="83.1621" y="111.079" width="94.8066" height="64.1178" rx="3" fill="#F4F0E6" fillOpacity="0.85"/>
            <circle cx="87.2722" cy="114.641" r="1.37004" fill="#C6A664" fillOpacity="0.5"/>
            <circle cx="91.1082" cy="114.641" r="1.37004" fill="#C6A664" fillOpacity="0.5"/>
            <circle cx="94.9444" cy="114.641" r="1.37004" fill="#C6A664" fillOpacity="0.5"/>
            <rect x="86.4501" y="119.3" width="87.6824" height="23.0166" fill="#C6A664" fillOpacity="0.5"/>
            <rect x="130.839" y="145.604" width="43.2932" height="9.31626" fill="#C6A664" fillOpacity="0.5"/>
            <rect x="86.4501" y="158.757" width="87.6824" height="9.31626" fill="#C6A664" fillOpacity="0.5"/>
            <rect x="86.4501" y="146.7" width="26.8527" height="2.74008" rx="1.37004" fill="#C6A664" fillOpacity="0.5"/>
            <rect x="86.4501" y="151.084" width="38.9091" height="2.74008" rx="1.37004" fill="#C6A664" fillOpacity="0.5"/>
            <path d="M133.507 39.0052C134.979 39.0052 136.173 37.8113 136.173 36.3386C136.173 34.8658 134.979 33.6719 133.507 33.6719C132.034 33.6719 130.84 34.8658 130.84 36.3386C130.84 37.8113 132.034 39.0052 133.507 39.0052ZM133.507 110.597L134.007 110.597L134.007 36.3386L133.507 36.3386L133.007 36.3386L133.007 110.597L133.507 110.597Z" fill="#0F5C4C"/>
            <path d="M133.507 244.597C132.034 244.597 130.84 245.791 130.84 247.264C130.84 248.737 132.034 249.931 133.507 249.931C134.979 249.931 136.173 248.737 136.173 247.264C136.173 245.791 134.979 244.597 133.507 244.597ZM133.507 175.376L133.007 175.376L133.007 247.264L133.507 247.264L134.007 247.264L134.007 175.376L133.507 175.376Z" fill="#0F5C4C"/>
            <path d="M194.954 69.9492C196.065 70.9161 197.75 70.7994 198.716 69.6885C199.683 68.5776 199.567 66.8932 198.456 65.9263C197.345 64.9594 195.66 65.0761 194.694 66.187C193.727 67.2979 193.843 68.9823 194.954 69.9492ZM159.576 110.597L159.953 110.925L197.082 68.266L196.705 67.9378L196.328 67.6095L159.199 110.268L159.576 110.597Z" fill="#0F5C4C"/>
            <path d="M57.629 61.4247C58.8312 60.5739 59.116 58.9097 58.2653 57.7075C57.4145 56.5054 55.7503 56.2205 54.5481 57.0713C53.3459 57.922 53.061 59.5863 53.9118 60.7884C54.7626 61.9906 56.4268 62.2755 57.629 61.4247ZM92.4276 110.597L92.8357 110.308L56.4967 58.9591L56.0885 59.248L55.6804 59.5368L92.0195 110.886L92.4276 110.597Z" fill="#0F5C4C"/>
            <path d="M61.4895 210.268C60.2538 209.466 58.6025 209.818 57.8011 211.054C56.9998 212.29 57.3519 213.941 58.5876 214.742C59.8232 215.544 61.4745 215.192 62.2759 213.956C63.0772 212.72 62.7251 211.069 61.4895 210.268ZM84.1169 175.376L83.6974 175.104L59.619 212.233L60.0385 212.505L60.458 212.777L84.5364 175.648L84.1169 175.376Z" fill="#0F5C4C"/>
            <path d="M199.913 210.323C198.707 211.169 198.416 212.832 199.262 214.037C200.109 215.243 201.772 215.534 202.977 214.687C204.183 213.841 204.474 212.178 203.627 210.973C202.781 209.767 201.118 209.476 199.913 210.323ZM175.376 175.376L174.966 175.663L201.036 212.792L201.445 212.505L201.854 212.218L175.785 175.089L175.376 175.376Z" fill="#0F5C4C"/>
            <path d="M231.167 139.036C231.167 140.509 232.361 141.703 233.834 141.703C235.307 141.703 236.501 140.509 236.501 139.036C236.501 137.563 235.307 136.369 233.834 136.369C232.361 136.369 231.167 137.563 231.167 139.036ZM177.746 139.036V139.536H233.834V139.036V138.536H177.746V139.036Z" fill="#0F5C4C"/>
            <path d="M31.8959 139.036C31.8959 137.563 30.702 136.369 29.2292 136.369C27.7565 136.369 26.5626 137.563 26.5626 139.036C26.5626 140.509 27.7565 141.703 29.2292 141.703C30.702 141.703 31.8959 140.509 31.8959 139.036ZM82.9479 139.036L82.9479 138.536L29.2292 138.536L29.2292 139.036L29.2292 139.536L82.9479 139.536L82.9479 139.036Z" fill="#0F5C4C"/>
            <path d="M134.483 11.4626C134.405 11.4619 134.317 11.4619 134.217 11.4619H130.553C129.636 11.4619 129.177 11.4619 128.827 11.6404C128.519 11.7974 128.269 12.0477 128.112 12.3558C127.933 12.7061 127.933 13.1649 127.933 14.082V23.5792C127.933 24.4963 127.933 24.9546 128.112 25.3048C128.269 25.6129 128.519 25.8637 128.827 26.0207C129.177 26.199 129.635 26.199 130.551 26.199L136.778 26.199C137.693 26.199 138.151 26.199 138.501 26.0207C138.809 25.8637 139.06 25.6129 139.217 25.3048C139.395 24.9549 139.395 24.4972 139.395 23.582V16.6409C139.395 16.5404 139.395 16.4525 139.395 16.3743M134.483 11.4626C134.717 11.4648 134.865 11.4732 135.006 11.5072C135.173 11.5473 135.333 11.6136 135.479 11.7034C135.644 11.8046 135.786 11.9465 136.069 12.2295L138.628 14.7884C138.911 15.0716 139.052 15.2128 139.153 15.378C139.243 15.5245 139.31 15.6843 139.35 15.8514C139.384 15.9925 139.392 16.1405 139.395 16.3743M134.483 11.4626V13.7543C134.483 14.6714 134.483 15.1296 134.661 15.4799C134.818 15.788 135.069 16.039 135.377 16.196C135.727 16.3743 136.185 16.3743 137.1 16.3743H139.395M139.395 16.3743H139.395" stroke="#0F5C4C" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            <circle cx="133.255" cy="18.4213" r="17.4213" stroke="#0F5C4C" strokeWidth="2"/>
            <path d="M126.867 263.351V269.795C126.867 270.224 126.867 270.439 126.951 270.603C127.024 270.747 127.141 270.865 127.286 270.939C127.45 271.022 127.664 271.022 128.093 271.022L136.38 271.022C136.809 271.022 137.024 271.022 137.188 270.939C137.333 270.865 137.449 270.748 137.523 270.603C137.607 270.439 137.607 270.224 137.607 269.795L137.608 266.42M126.867 263.351H132.237M126.867 263.351L126.867 263.044C126.867 262.615 126.867 262.4 126.951 262.235C127.024 262.091 127.141 261.974 127.286 261.9C127.45 261.817 127.665 261.817 128.094 261.817L129.936 261.817M132.237 263.351H136.379C136.809 263.351 137.025 263.351 137.189 263.435C137.334 263.508 137.449 263.625 137.523 263.77C137.607 263.934 137.607 264.149 137.607 264.578L137.608 266.42M132.237 263.351L131.412 262.29C131.277 262.117 131.209 262.029 131.124 261.967C131.049 261.911 130.966 261.87 130.876 261.845C130.775 261.817 130.663 261.817 130.443 261.817L129.936 261.817M129.936 258.748H139.448C139.878 258.748 140.094 258.748 140.258 258.832C140.402 258.905 140.518 259.023 140.591 259.167C140.675 259.331 140.675 259.546 140.675 259.975V265.192C140.675 265.622 140.675 265.836 140.591 266.001C140.518 266.145 140.402 266.262 140.257 266.336C140.093 266.419 139.879 266.419 139.45 266.419L137.608 266.42M129.936 258.748V261.817M129.936 258.748L129.936 258.441C129.936 258.012 129.936 257.797 130.019 257.633C130.093 257.488 130.21 257.371 130.354 257.297C130.518 257.214 130.733 257.214 131.163 257.214H133.512C133.732 257.214 133.841 257.214 133.943 257.242C134.033 257.267 134.118 257.309 134.193 257.364C134.278 257.427 134.345 257.514 134.481 257.688L135.305 258.748" stroke="#0F5C4C" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            <circle cx="133.388" cy="263.734" r="16.2605" stroke="#0F5C4C" strokeWidth="2"/>
            <path d="M208.657 55.1994L205.968 57.8889L204.623 56.5441M214.036 57.8889C214.036 56.4035 212.832 55.1994 211.347 55.1994C211.331 55.1994 211.315 55.1995 211.3 55.1998C210.973 52.9186 209.011 51.165 206.64 51.165C204.76 51.165 203.137 52.2678 202.383 53.8619C200.63 53.9766 199.244 55.4346 199.244 57.2164C199.244 59.0732 200.749 60.5785 202.606 60.5785L211.347 60.5785C212.832 60.5785 214.036 59.3743 214.036 57.8889Z" stroke="#0F5C4C" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            <circle cx="206.304" cy="56.2078" r="14.1287" stroke="#0F5C4C" strokeWidth="2"/>
            <path d="M59.1905 51.5361C59.1905 50.125 57.3508 48.981 55.0814 48.981C52.8121 48.981 50.9724 50.125 50.9724 51.5361M62.4777 48.9813C62.4777 47.9336 61.4635 47.0332 60.0123 46.6389M47.6852 48.9813C47.6852 47.9336 48.6994 47.0332 50.1506 46.6389M60.0123 43.2203C60.5167 42.7524 60.8341 42.0725 60.8341 41.3158C60.8341 39.9047 59.7303 38.7607 58.3687 38.7607C57.7372 38.7607 57.1612 39.0068 56.7251 39.4113M50.1506 43.2203C49.6462 42.7524 49.3288 42.0725 49.3288 41.3158C49.3288 39.9047 50.4326 38.7607 51.7942 38.7607C52.4257 38.7607 53.0016 39.0068 53.4378 39.4113M55.0814 46.426C53.7198 46.426 52.616 45.282 52.616 43.8709C52.616 42.4598 53.7198 41.3158 55.0814 41.3158C56.4431 41.3158 57.5469 42.4598 57.5469 43.8709C57.5469 45.282 56.4431 46.426 55.0814 46.426Z" stroke="#0F5C4C" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            <circle cx="55.4177" cy="45.1482" r="14.1287" stroke="#0F5C4C" strokeWidth="2"/>
            <path d="M52.1567 223.583V229.634M52.1567 223.583H49.1979C48.8214 223.583 48.6333 223.583 48.4894 223.656C48.3629 223.72 48.2601 223.823 48.1957 223.95C48.1224 224.094 48.1224 224.282 48.1224 224.659V229.634H52.1567M52.1567 223.583V219.952C52.1567 219.575 52.1567 219.387 52.23 219.243C52.2945 219.117 52.3972 219.014 52.5238 218.949C52.6676 218.876 52.8557 218.876 53.2323 218.876H55.1149C55.4915 218.876 55.6802 218.876 55.824 218.949C55.9505 219.014 56.053 219.117 56.1175 219.243C56.1908 219.387 56.191 219.575 56.191 219.952V221.566M52.1567 229.634H56.191M56.191 229.634L60.2254 229.634V222.641C60.2254 222.265 60.2251 222.076 60.1518 221.933C60.0873 221.806 59.9853 221.703 59.8587 221.639C59.7149 221.566 59.5261 221.566 59.1495 221.566H56.191M56.191 229.634V221.566" stroke="#0F5C4C" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            <circle cx="53.8378" cy="225.263" r="14.1287" stroke="#0F5C4C" strokeWidth="2"/>
            <path d="M211.38 221.868V228.726M211.38 221.868C211.38 220.738 211.38 220.174 211.6 219.742C211.793 219.363 212.101 219.054 212.481 218.86C212.913 218.641 213.477 218.641 214.607 218.641H216.355C216.732 218.641 216.92 218.641 217.064 218.714C217.191 218.778 217.293 218.881 217.358 219.008C217.431 219.152 217.431 219.34 217.431 219.717V225.634C217.431 226.01 217.431 226.198 217.358 226.342C217.293 226.468 217.191 226.572 217.064 226.636C216.921 226.709 216.733 226.709 216.357 226.709H214.452C213.821 226.709 213.504 226.709 213.218 226.796C212.964 226.873 212.728 227 212.524 227.168C212.292 227.358 212.117 227.621 211.767 228.146L211.38 228.726M211.38 221.868C211.38 220.738 211.38 220.174 211.16 219.742C210.966 219.363 210.658 219.054 210.278 218.86C209.847 218.641 209.282 218.641 208.152 218.641H206.404C206.027 218.641 205.839 218.641 205.695 218.714C205.569 218.778 205.466 218.881 205.402 219.008C205.328 219.152 205.328 219.34 205.328 219.717V225.634C205.328 226.01 205.328 226.198 205.402 226.342C205.466 226.468 205.569 226.572 205.695 226.636C205.839 226.709 206.027 226.709 206.403 226.709H208.308C208.939 226.709 209.255 226.709 209.541 226.796C209.795 226.873 210.032 227 210.237 227.168C210.467 227.357 210.641 227.619 210.989 228.14L211.38 228.726" stroke="#0F5C4C" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            <circle cx="211.044" cy="223.683" r="14.1287" stroke="#0F5C4C" strokeWidth="2"/>
            <circle cx="248.173" cy="137.638" r="14.1287" stroke="#0F5C4C" strokeWidth="2"/>
            <path d="M252.543 137.975V141.337C252.543 142.451 250.737 143.354 248.509 143.354C246.281 143.354 244.475 142.451 244.475 141.337V137.975M252.543 137.975V134.613M252.543 137.975C252.543 139.089 250.737 139.992 248.509 139.992C246.281 139.992 244.475 139.089 244.475 137.975M252.543 134.613C252.543 133.499 250.737 132.596 248.509 132.596C246.281 132.596 244.475 133.499 244.475 134.613M252.543 134.613C252.543 135.727 250.737 136.63 248.509 136.63C246.281 136.63 244.475 135.727 244.475 134.613M244.475 137.975V134.613" stroke="#0F5C4C" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            <circle cx="15.1287" cy="137.638" r="14.1287" stroke="#0F5C4C" strokeWidth="2"/>
            <path d="M21.0767 136.193L20.8305 136.056C20.7923 136.035 20.7735 136.024 20.755 136.013C20.5714 135.903 20.4166 135.751 20.3037 135.569C20.2923 135.551 20.2816 135.532 20.2597 135.494C20.2378 135.456 20.2267 135.437 20.2165 135.418C20.1152 135.229 20.0604 135.018 20.0572 134.803C20.0568 134.782 20.0569 134.76 20.0576 134.716L20.0625 134.43C20.0702 133.972 20.074 133.743 20.0097 133.537C19.9526 133.354 19.857 133.185 19.7294 133.042C19.5852 132.881 19.3855 132.765 18.9858 132.535L18.6538 132.344C18.2552 132.114 18.0558 131.999 17.8442 131.955C17.6569 131.917 17.4637 131.918 17.2772 131.96C17.0666 132.008 16.8697 132.125 16.4762 132.361L16.474 132.362L16.2361 132.505C16.1984 132.527 16.1794 132.538 16.1606 132.549C15.9734 132.653 15.7646 132.71 15.5506 132.717C15.529 132.718 15.5071 132.718 15.4632 132.718C15.4196 132.718 15.3967 132.718 15.3752 132.717C15.1608 132.71 14.9515 132.653 14.7641 132.548C14.7452 132.538 14.7265 132.526 14.6888 132.504L14.4494 132.36C14.0532 132.122 13.8548 132.003 13.643 131.955C13.4557 131.913 13.2619 131.912 13.074 131.951C12.8618 131.996 12.6624 132.111 12.2635 132.343L12.2617 132.344L11.9338 132.534L11.9302 132.536C11.535 132.766 11.3368 132.881 11.1938 133.042C11.0669 133.184 10.972 133.353 10.9152 133.535C10.8511 133.741 10.8545 133.971 10.8622 134.431L10.867 134.717C10.8678 134.76 10.869 134.781 10.8687 134.803C10.8655 135.018 10.81 135.229 10.7084 135.418C10.6983 135.437 10.6875 135.456 10.6659 135.493C10.6442 135.531 10.6338 135.549 10.6226 135.567C10.5091 135.75 10.3536 135.903 10.1689 136.013C10.1506 136.024 10.1313 136.035 10.0935 136.056L9.85036 136.19C9.44587 136.415 9.24367 136.527 9.09655 136.686C8.96639 136.828 8.86807 136.995 8.80805 137.177C8.7402 137.384 8.74026 137.615 8.74131 138.077L8.74217 138.455C8.74321 138.915 8.74464 139.144 8.81264 139.349C8.8728 139.53 8.9704 139.697 9.09983 139.837C9.24613 139.996 9.44631 140.107 9.84773 140.331L10.0887 140.465C10.1297 140.487 10.1503 140.499 10.1701 140.511C10.3532 140.621 10.5074 140.773 10.6199 140.955C10.6321 140.975 10.6437 140.995 10.6671 141.036C10.6901 141.076 10.7019 141.096 10.7126 141.116C10.8112 141.303 10.864 141.511 10.8676 141.722C10.868 141.745 10.8676 141.768 10.8668 141.814L10.8622 142.088C10.8544 142.549 10.851 142.78 10.9156 142.987C10.9727 143.17 11.0682 143.338 11.1958 143.481C11.34 143.643 11.54 143.758 11.9397 143.989L12.2717 144.18C12.6703 144.41 12.8696 144.524 13.0812 144.568C13.2684 144.607 13.4617 144.605 13.6483 144.564C13.8591 144.516 14.0567 144.398 14.4514 144.162L14.6893 144.019C14.7269 143.997 14.746 143.985 14.7648 143.975C14.9519 143.871 15.1606 143.813 15.3746 143.806C15.3961 143.806 15.4181 143.806 15.4619 143.806C15.5059 143.806 15.5278 143.806 15.5494 143.806C15.7639 143.813 15.9738 143.871 16.1612 143.976C16.1777 143.985 16.1942 143.995 16.2232 144.012L16.4761 144.164C16.8724 144.402 17.0704 144.521 17.2821 144.568C17.4694 144.61 17.6635 144.612 17.8514 144.573C18.0635 144.528 18.2633 144.412 18.6619 144.181L18.9948 143.988C19.3903 143.758 19.5886 143.643 19.7317 143.482C19.8586 143.339 19.9536 143.171 20.0104 142.989C20.0741 142.784 20.0702 142.556 20.0626 142.103L20.0576 141.807C20.0569 141.764 20.0568 141.742 20.0571 141.721C20.0603 141.506 20.1149 141.295 20.2165 141.105C20.2266 141.086 20.2375 141.068 20.259 141.03C20.2807 140.993 20.2919 140.974 20.3031 140.956C20.4165 140.773 20.5722 140.62 20.757 140.51C20.775 140.499 20.7936 140.489 20.8305 140.469L20.8318 140.468L21.0749 140.333C21.4794 140.109 21.682 139.997 21.8291 139.837C21.9593 139.696 22.0575 139.529 22.1175 139.346C22.1849 139.141 22.1844 138.911 22.1834 138.454L22.1825 138.068C22.1815 137.609 22.1809 137.379 22.1129 137.175C22.0527 136.993 21.9546 136.827 21.8252 136.686C21.679 136.528 21.4785 136.416 21.0779 136.194L21.0767 136.193Z" stroke="#0F5C4C" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            <path d="M12.773 138.262C12.773 139.747 13.9772 140.951 15.4626 140.951C16.948 140.951 18.1521 139.747 18.1521 138.262C18.1521 136.777 16.948 135.572 15.4626 135.572C13.9772 135.572 12.773 136.777 12.773 138.262Z" stroke="#0F5C4C" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
          </svg>
        </Box>
      </Box>

      <Typography variant="h6" sx={{ color: 'text.primary', fontWeight: 500 }}>
        {message}
      </Typography>
    </Box>
  )
}

